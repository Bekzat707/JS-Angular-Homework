<div class="container">
  <h2>Signup</h2>
  <form [formGroup]="signupForm" (ngSubmit)="signup()">

    <!-- Email Input -->
    <div>
      <input type="email" formControlName="email" placeholder="Email" required>
      <div *ngIf="f['email'].invalid && (f['email'].dirty || f['email'].touched)" class="error-message">
        <div *ngIf="f['email'].errors?.['required']">Email is required.</div>
        <div *ngIf="f['email'].errors?.['email']">Email must be a valid email address.</div>
      </div>
    </div>

    <!-- Password Input -->
    <div>
      <input type="password" formControlName="password" placeholder="Password" required>
      <div *ngIf="f['password'].invalid && (f['password'].dirty || f['password'].touched)" class="error-message">
        <div *ngIf="f['password'].errors?.['required']">Password is required.</div>
        <div *ngIf="f['password'].errors?.['passwordComplexity']">
          Password must meet the following criteria:
          <ul>
            <li
              [class.valid]="f['password'].errors?.['passwordComplexity']?.requiredLength === 8 || !f['password'].errors?.['passwordComplexity']">
              Minimum 8 characters</li>
            <li [class.valid]="f['password'].errors?.['passwordComplexity']?.hasNumber">At least one number</li>
            <li [class.valid]="f['password'].errors?.['passwordComplexity']?.hasSpecial">At least one special character
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Repeat Password Input -->
    <div>
      <input type="password" formControlName="repeatPassword" placeholder="Repeat Password" required>
      <div *ngIf="f['repeatPassword'].invalid && (f['repeatPassword'].dirty || f['repeatPassword'].touched)"
        class="error-message">
        <div *ngIf="f['repeatPassword'].errors?.['required']">Repeat Password is required.</div>
        <div *ngIf="f['repeatPassword'].errors?.['passwordsMatch']">Passwords must match.</div>
      </div>
    </div>

    <button type="submit" [disabled]="signupForm.invalid || loading">
      {{ loading ? 'Signing up...' : 'Signup' }}
    </button>
  </form>

  <p class="error" *ngIf="error">{{ error }}</p>
</div>

<style>
  .error-message {
    color: #000000;
    background: #f8f8f8;
    font-size: 0.85rem;
    margin-top: 8px;
    padding: 10px;
    border-radius: 8px;
    border-left: 3px solid #000000;
    font-weight: 600;
  }

  .error-message ul {
    list-style: none;
    padding-left: 0;
    margin-top: 8px;
  }

  .error-message li {
    color: #000000;
    padding: 4px 0;
    position: relative;
    padding-left: 20px;
  }

  .error-message li::before {
    content: '✗';
    position: absolute;
    left: 0;
    font-weight: bold;
  }

  .error-message li.valid {
    color: #2d2d2d;
    opacity: 0.6;
  }

  .error-message li.valid::before {
    content: '✓';
  }
</style>